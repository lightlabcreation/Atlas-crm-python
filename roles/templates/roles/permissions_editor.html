{% extends 'base.html' %}
{% load static %}

{% block title %}Permissions Editor{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-100">
    <!-- Header -->
    <div class="bg-gray-50 border-b border-gray-300">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-semibold text-orange-600">Permissions Editor</h1>
                    <p class="mt-1 text-sm text-gray-500">Manage role permissions for system features</p>
                </div>
                <div class="flex space-x-3">
                    <a href="{% url 'roles:role_list' %}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm font-medium">
                        Back to Roles
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <form method="post">
            {% csrf_token %}
            
            <!-- Permissions Table -->
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-medium text-gray-900">Feature Permissions</h3>
                            <p class="text-sm text-gray-500">Select permissions for each system feature</p>
                        </div>
                        <div class="flex space-x-2">
                            <button type="button" onclick="selectAll()" class="bg-green-100 hover:bg-green-200 text-green-700 px-3 py-1 rounded text-sm font-medium">
                                Select All
                            </button>
                            <button type="button" onclick="deselectAll()" class="bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1 rounded text-sm font-medium">
                                Deselect All
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <!-- Header Row -->
                        <thead>
                            <tr>
                                <th class="text-left text-sm font-medium">Features</th>
                                <th class="text-center text-sm font-medium">Read</th>
                                <th class="text-center text-sm font-medium">Create</th>
                                <th class="text-center text-sm font-medium">Delete</th>
                                <th class="text-center text-sm font-medium">Edit</th>
                            </tr>
                        </thead>
                        
                        <!-- Body Rows -->
                        <tbody>
                            <!-- Dashboard -->
                            <tr>
                                <td class="text-sm font-medium">Dashboard</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="dashboard_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="dashboard_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="dashboard_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="dashboard_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Users -->
                            <tr >
                                <td class="text-sm font-medium">Users</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="users_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="users_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="users_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="users_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Sellers -->
                            <tr >
                                <td class="text-sm font-medium">Sellers</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sellers_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sellers_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sellers_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sellers_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Orders -->
                            <tr >
                                <td class="text-sm font-medium">Orders</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="orders_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="orders_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="orders_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="orders_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Products -->
                            <tr >
                                <td class="text-sm font-medium">Products</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="products_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="products_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="products_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="products_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Inventory -->
                            <tr >
                                <td class="text-sm font-medium">Inventory</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="inventory_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="inventory_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="inventory_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="inventory_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Finance -->
                            <tr >
                                <td class="text-sm font-medium">Finance</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="finance_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="finance_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="finance_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="finance_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Sourcing -->
                            <tr >
                                <td class="text-sm font-medium">Sourcing</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Sourcing Request -->
                            <tr >
                                <td class="text-sm font-medium">Sourcing Request</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_request_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_request_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_request_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="sourcing_request_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Packaging -->
                            <tr >
                                <td class="text-sm font-medium">Packaging</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="packaging_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="packaging_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="packaging_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="packaging_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Call Center -->
                            <tr >
                                <td class="text-sm font-medium">Call Center</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="callcenter_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="callcenter_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="callcenter_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="callcenter_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Delivery -->
                            <tr >
                                <td class="text-sm font-medium">Delivery</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="delivery_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="delivery_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="delivery_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="delivery_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Subscribers -->
                            <tr >
                                <td class="text-sm font-medium">Subscribers</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="subscribers_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="subscribers_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="subscribers_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="subscribers_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Roles and Permissions -->
                            <tr >
                                <td class="text-sm font-medium">Roles and Permissions</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="roles_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="roles_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="roles_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="roles_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Fees Management -->
                            <tr >
                                <td class="text-sm font-medium">Fees Management</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="fees_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="fees_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="fees_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="fees_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Country Management -->
                            <tr >
                                <td class="text-sm font-medium">Country Management</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="country_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="country_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="country_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="country_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Zones -->
                            <tr >
                                <td class="text-sm font-medium">Zones</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="zones_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="zones_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="zones_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="zones_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Refund -->
                            <tr >
                                <td class="text-sm font-medium">Refund</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="refund_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="refund_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="refund_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="refund_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                            
                            <!-- Payments -->
                            <tr >
                                <td class="text-sm font-medium">Payments</td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="payments_read" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="payments_create" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="payments_delete" 
                                           class="permission-checkbox">
                                </td>
                                <td class="text-center">
                                    <input type="checkbox" name="permissions" value="payments_edit" 
                                           class="permission-checkbox">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="mt-6 flex justify-end space-x-3">
                <a href="{% url 'roles:role_list' %}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm font-medium">
                    Cancel
                </a>
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium">
                    Save Permissions
                </button>
            </div>
        </form>
    </div>
</div>

<style>
/* Custom styling for circular checkboxes */
.permission-checkbox {
    appearance: none;
    width: 18px;
    height: 18px;
    border: 2px solid #d1d5db;
    border-radius: 50%;
    background-color: #ffffff;
    cursor: pointer;
    position: relative;
    transition: all 0.2s ease;
    display: inline-block;
}

.permission-checkbox:hover {
    border-color: #3b82f6;
    background-color: #f8fafc;
    transform: scale(1.1);
}

.permission-checkbox:checked {
    background-color: #3b82f6;
    border-color: #3b82f6;
}

.permission-checkbox:checked::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 10px;
    font-weight: bold;
}

/* Table styling */
table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
}

th {
    position: sticky;
    top: 0;
    z-index: 10;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

tr:hover {
    background-color: #f8fafc;
}

/* Yellow header styling */
thead tr {
    background-color: #fbbf24 !important;
}

thead th {
    background-color: #fbbf24 !important;
    color: #1f2937 !important;
    font-weight: 700;
    padding: 12px 16px;
    border: none;
    font-size: 14px;
}

/* Table rows styling */
tbody tr {
    border-bottom: 1px solid #e5e7eb;
}

tbody tr:last-child {
    border-bottom: none;
}

tbody td {
    padding: 12px 16px;
    vertical-align: middle;
}

/* Feature name styling */
tbody td:first-child {
    font-weight: 500;
    color: #374151;
}

/* Checkbox container styling */
td {
    text-align: center;
    vertical-align: middle;
}

/* Responsive design */
@media (max-width: 768px) {
    .overflow-x-auto {
        overflow-x: auto;
    }
    
    table {
        min-width: 600px;
    }
}
</style>

<script>
// Select all permissions for a feature
function selectAllForFeature(featureName) {
    const checkboxes = document.querySelectorAll(`.permission-checkbox[value^="${featureName}_"]`);
    checkboxes.forEach(checkbox => {
        checkbox.checked = true;
    });
}

// Deselect all permissions for a feature
function deselectAllForFeature(featureName) {
    const checkboxes = document.querySelectorAll(`.permission-checkbox[value^="${featureName}_"]`);
    checkboxes.forEach(checkbox => {
        checkbox.checked = false;
    });
}

// Select all permissions
function selectAll() {
    const checkboxes = document.querySelectorAll('.permission-checkbox');
    checkboxes.forEach(checkbox => {
        checkbox.checked = true;
    });
}

// Deselect all permissions
function deselectAll() {
    const checkboxes = document.querySelectorAll('.permission-checkbox');
    checkboxes.forEach(checkbox => {
        checkbox.checked = false;
    });
}
</script>
{% endblock %}
