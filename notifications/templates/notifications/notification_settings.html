{% extends 'base.html' %}

{% block title %}Notification Settings{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 pt-16">
    <!-- Enhanced Page Header -->
    <div class="relative overflow-hidden bg-gradient-to-r from-slate-800 via-slate-900 to-slate-800 border-b border-amber-500/20 shadow-2xl">
        <div class="absolute inset-0 bg-gradient-to-r from-amber-500/10 via-yellow-500/10 to-amber-500/10"></div>
        <div class="relative max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="flex items-center space-x-4">
                <div class="w-16 h-16 bg-gradient-to-br from-amber-400 via-yellow-500 to-amber-600 rounded-2xl flex items-center justify-center shadow-2xl shadow-amber-500/25">
                    <i class="fas fa-cog text-3xl text-slate-900"></i>
                </div>
                <div>
                    <h1 class="text-4xl lg:text-5xl font-bold bg-gradient-to-r from-amber-400 via-yellow-300 to-amber-400 bg-clip-text text-transparent">
                        Notification Settings
                    </h1>
                    <p class="mt-2 text-lg text-slate-300 font-medium">Customize your notification preferences</p>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8 space-y-8">
        <!-- User Profile Card -->
        <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-slate-200/60 overflow-hidden">
            <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center">
                        <i class="fas fa-user text-slate-900 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-white">User Profile</h3>
                        <p class="text-slate-300 text-sm">Your account information and preferences</p>
                    </div>
                </div>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Username</label>
                        <input type="text" value="{{ user.username }}" readonly class="w-full px-4 py-3 bg-slate-100 border border-slate-200 rounded-xl text-slate-600">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Email</label>
                        <input type="email" value="{{ user.email }}" readonly class="w-full px-4 py-3 bg-slate-100 border border-slate-200 rounded-xl text-slate-600">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Full Name</label>
                        <input type="text" value="{{ user.full_name|default:'Not provided' }}" readonly class="w-full px-4 py-3 bg-slate-100 border border-slate-200 rounded-xl text-slate-600">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Role</label>
                        <input type="text" value="{{ user.get_role_display|default:'Not assigned' }}" readonly class="w-full px-4 py-3 bg-slate-100 border border-slate-200 rounded-xl text-slate-600">
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification Preferences -->
        <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-slate-200/60 overflow-hidden">
            <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center">
                        <i class="fas fa-bell text-slate-900 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-white">Notification Preferences</h3>
                        <p class="text-slate-300 text-sm">Choose which notifications you want to receive</p>
                    </div>
                </div>
            </div>
            <div class="p-6">
                <form method="post" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Notification Types -->
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900 mb-4">Notification Types</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for type_code, type_name in notification_types %}
                            <div class="flex items-center space-x-3 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <input type="checkbox" id="type_{{ type_code }}" name="notification_types" value="{{ type_code }}" 
                                       class="w-4 h-4 text-amber-600 bg-slate-100 border-slate-300 rounded focus:ring-amber-500 focus:ring-2">
                                <label for="type_{{ type_code }}" class="text-sm font-medium text-slate-700">{{ type_name }}</label>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Priority Levels -->
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900 mb-4">Priority Levels</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for priority_code, priority_name in priority_levels %}
                            <div class="flex items-center space-x-3 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <input type="checkbox" id="priority_{{ priority_code }}" name="priority_levels" value="{{ priority_code }}" 
                                       class="w-4 h-4 text-amber-600 bg-slate-100 border-slate-300 rounded focus:ring-amber-500 focus:ring-2">
                                <label for="priority_{{ priority_code }}" class="text-sm font-medium text-slate-700">{{ priority_name }}</label>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Delivery Settings -->
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900 mb-4">Delivery Settings</h4>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-3 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <input type="checkbox" id="email_notifications" name="email_notifications" 
                                       class="w-4 h-4 text-amber-600 bg-slate-100 border-slate-300 rounded focus:ring-amber-500 focus:ring-2">
                                <label for="email_notifications" class="text-sm font-medium text-slate-700">Receive email notifications</label>
                            </div>
                            <div class="flex items-center space-x-3 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <input type="checkbox" id="browser_notifications" name="browser_notifications" 
                                       class="w-4 h-4 text-amber-600 bg-slate-100 border-slate-300 rounded focus:ring-amber-500 focus:ring-2">
                                <label for="browser_notifications" class="text-sm font-medium text-slate-700">Enable browser notifications</label>
                            </div>
                            <div class="flex items-center space-x-3 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <input type="checkbox" id="auto_archive" name="auto_archive" 
                                       class="w-4 h-4 text-amber-600 bg-slate-100 border-slate-300 rounded focus:ring-amber-500 focus:ring-2">
                                <label for="auto_archive" class="text-sm font-medium text-slate-700">Auto-archive read notifications after 30 days</label>
                            </div>
                        </div>
                    </div>

                    <!-- Frequency Settings -->
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900 mb-4">Update Frequency</h4>
                        <div class="space-y-4">
                            <div>
                                <label for="update_frequency" class="block text-sm font-semibold text-slate-700 mb-2">Real-time updates</label>
                                <select id="update_frequency" name="update_frequency" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-all duration-200">
                                    <option value="realtime">Real-time (immediate)</option>
                                    <option value="5min">Every 5 minutes</option>
                                    <option value="15min">Every 15 minutes</option>
                                    <option value="30min">Every 30 minutes</option>
                                    <option value="1hour">Every hour</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex items-center justify-between pt-6 border-t border-slate-200">
                        <button type="submit" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-600 hover:to-yellow-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-save mr-2"></i>
                            Save Settings
                        </button>
                        <a href="{% url 'notifications:index' %}" class="text-slate-600 hover:text-slate-800 font-medium transition-colors duration-200">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Back to Notifications
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Information Card -->
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl p-6 border border-blue-200">
            <div class="flex items-start space-x-4">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-xl flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-info-circle text-white text-xl"></i>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-blue-900 mb-2">About Notification Settings</h4>
                    <p class="text-blue-700 leading-relaxed">
                        These settings allow you to customize how and when you receive notifications. 
                        You can choose which types of notifications to receive, set priority levels, 
                        and configure delivery preferences. Changes are saved automatically and apply 
                        to all future notifications.
                    </p>
                    <div class="mt-4 text-sm text-blue-600">
                        <p><strong>Note:</strong> Some system notifications cannot be disabled for security and operational reasons.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Enhanced animations */
@keyframes fade-in {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.animate-fade-in {
    animation: fade-in 0.3s ease-out;
}

/* Responsive design */
@media (max-width: 768px) {
    .grid {
        @apply grid-cols-1;
    }
    
    .text-2xl {
        @apply text-xl;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set default values for form fields
    const emailNotifications = document.getElementById('email_notifications');
    const browserNotifications = document.getElementById('browser_notifications');
    const autoArchive = document.getElementById('auto_archive');
    const updateFrequency = document.getElementById('update_frequency');
    
    // Set default values (you can modify these based on user preferences)
    if (emailNotifications) emailNotifications.checked = true;
    if (browserNotifications) browserNotifications.checked = true;
    if (autoArchive) autoArchive.checked = true;
    if (updateFrequency) updateFrequency.value = 'realtime';
    
    // Form submission handling
    const form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show success message
            const button = form.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check mr-2"></i>Settings Saved!';
            button.classList.remove('from-amber-500', 'to-yellow-500', 'hover:from-amber-600', 'hover:to-yellow-600');
            button.classList.add('from-green-500', 'to-emerald-500', 'hover:from-green-600', 'hover:to-emerald-600');
            
            // Reset button after 3 seconds
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('from-green-500', 'to-emerald-500', 'hover:from-green-600', 'hover:to-emerald-600');
                button.classList.add('from-amber-500', 'to-yellow-500', 'hover:from-amber-600', 'hover:to-yellow-600');
            }, 3000);
        });
    }
});
</script>
{% endblock %}
