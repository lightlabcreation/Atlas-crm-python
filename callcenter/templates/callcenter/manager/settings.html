{% extends 'base.html' %}
{% load static %}

{% block title %}Call Center Settings{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-amber-50/30 to-yellow-50/20">
    <!-- Enhanced Page Header -->
    <div class="bg-gradient-to-r from-amber-500 to-yellow-600 shadow-2xl border-b-4 border-amber-400">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
                <div class="space-y-2">
                    <div class="flex items-center gap-3">
                        <a href="{% url 'callcenter:manager_dashboard' %}" class="w-10 h-10 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center hover:bg-white/30 transition-all duration-200">
                            <i class="fas fa-arrow-left text-white text-lg"></i>
                        </a>
                        <div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center">
                            <i class="fas fa-cog text-white text-xl"></i>
                        </div>
                        <div>
                            <h1 class="text-4xl font-bold text-white">Call Center Settings</h1>
                            <p class="text-amber-100 text-lg">Configure system preferences and behavior</p>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-3">
                    <button onclick="saveSettings()" class="inline-flex items-center justify-center px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 border border-green-400/20">
                        <i class="fas fa-save mr-2"></i>
                        Save Settings
                    </button>
                    <button onclick="resetSettings()" class="inline-flex items-center justify-center px-8 py-3 bg-white/20 backdrop-blur-sm text-white font-semibold rounded-xl hover:bg-white/30 transition-all duration-200 border border-white/30">
                        <i class="fas fa-undo mr-2"></i>
                        Reset to Default
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        <!-- Enhanced Settings Form -->
        <form method="POST" class="space-y-8">
            {% csrf_token %}
            
            <!-- General Settings Section -->
            <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-sliders-h text-slate-900 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">General Settings</h3>
                            <p class="text-slate-300 text-sm">Basic call center configuration</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="center_name" class="block text-sm font-semibold text-slate-700 mb-2">Call Center Name</label>
                            <input type="text" id="center_name" name="center_name" value="Main Call Center" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="timezone" class="block text-sm font-semibold text-slate-700 mb-2">Timezone</label>
                            <select id="timezone" name="timezone" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="UTC">UTC</option>
                                <option value="EST" selected>Eastern Standard Time</option>
                                <option value="PST">Pacific Standard Time</option>
                                <option value="GMT">Greenwich Mean Time</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="business_hours_start" class="block text-sm font-semibold text-slate-700 mb-2">Business Hours Start</label>
                            <input type="time" id="business_hours_start" name="business_hours_start" value="09:00" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="business_hours_end" class="block text-sm font-semibold text-slate-700 mb-2">Business Hours End</label>
                            <input type="time" id="business_hours_end" name="business_hours_end" value="17:00" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                    </div>
                    
                    <div>
                        <label for="welcome_message" class="block text-sm font-semibold text-slate-700 mb-2">Welcome Message</label>
                        <textarea id="welcome_message" name="welcome_message" rows="3" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200 resize-none" placeholder="Enter the welcome message for incoming calls...">Welcome to our call center. How may we assist you today?</textarea>
                    </div>
                </div>
            </div>

            <!-- Call Handling Settings Section -->
            <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-phone text-slate-900 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Call Handling Settings</h3>
                            <p class="text-slate-300 text-sm">Configure how calls are processed</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="max_wait_time" class="block text-sm font-semibold text-slate-700 mb-2">Maximum Wait Time (minutes)</label>
                            <input type="number" id="max_wait_time" name="max_wait_time" value="5" min="1" max="60" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="ring_timeout" class="block text-sm font-semibold text-slate-700 mb-2">Ring Timeout (seconds)</label>
                            <input type="number" id="ring_timeout" name="ring_timeout" value="30" min="10" max="120" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="auto_assign" class="block text-sm font-semibold text-slate-700 mb-2">Auto-Assignment</label>
                            <select id="auto_assign" name="auto_assign" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="enabled" selected>Enabled</option>
                                <option value="disabled">Disabled</option>
                                <option value="manual">Manual Only</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="assignment_strategy" class="block text-sm font-semibold text-slate-700 mb-2">Assignment Strategy</label>
                            <select id="assignment_strategy" name="assignment_strategy" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="round_robin" selected>Round Robin</option>
                                <option value="least_busy">Least Busy</option>
                                <option value="most_skilled">Most Skilled</option>
                                <option value="random">Random</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="voicemail_enabled" name="voicemail_enabled" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Enable Voicemail</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="call_recording" name="call_recording" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Enable Call Recording</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="call_monitoring" name="call_monitoring" class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Enable Call Monitoring</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Quality Assurance Settings Section -->
            <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-star text-slate-900 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Quality Assurance Settings</h3>
                            <p class="text-slate-300 text-sm">Configure quality monitoring and evaluation</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="qa_enabled" class="block text-sm font-semibold text-slate-700 mb-2">Quality Assurance</label>
                            <select id="qa_enabled" name="qa_enabled" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="enabled" selected>Enabled</option>
                                <option value="disabled">Disabled</option>
                                <option value="sampling">Sampling Only</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="qa_sample_rate" class="block text-sm font-semibold text-slate-700 mb-2">QA Sample Rate (%)</label>
                            <input type="number" id="qa_sample_rate" name="qa_sample_rate" value="20" min="5" max="100" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="min_qa_score" class="block text-sm font-semibold text-slate-700 mb-2">Minimum QA Score</label>
                            <input type="number" id="min_qa_score" name="min_qa_score" value="80" min="0" max="100" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="qa_frequency" class="block text-sm font-semibold text-slate-700 mb-2">QA Evaluation Frequency</label>
                            <select id="qa_frequency" name="qa_frequency" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="weekly" selected>Weekly</option>
                                <option value="biweekly">Bi-weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label for="qa_criteria" class="block text-sm font-semibold text-slate-700 mb-2">QA Evaluation Criteria</label>
                        <textarea id="qa_criteria" name="qa_criteria" rows="4" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200 resize-none" placeholder="Enter the criteria used for quality evaluation...">1. Greeting and Introduction
2. Problem Identification
3. Solution Provided
4. Customer Satisfaction
5. Call Handling Efficiency</textarea>
                    </div>
                </div>
            </div>

            <!-- Notification Settings Section -->
            <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-bell text-slate-900 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Notification Settings</h3>
                            <p class="text-slate-300 text-sm">Configure alerts and notifications</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="email_notifications" class="block text-sm font-semibold text-slate-700 mb-2">Email Notifications</label>
                            <select id="email_notifications" name="email_notifications" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="enabled" selected>Enabled</option>
                                <option value="disabled">Disabled</option>
                                <option value="critical_only">Critical Only</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="sms_notifications" class="block text-sm font-semibold text-slate-700 mb-2">SMS Notifications</label>
                            <select id="sms_notifications" name="sms_notifications" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="enabled">Enabled</option>
                                <option value="disabled" selected>Disabled</option>
                                <option value="emergency_only">Emergency Only</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="notification_email" class="block text-sm font-semibold text-slate-700 mb-2">Notification Email</label>
                            <input type="email" id="notification_email" name="notification_email" value="manager@callcenter.com" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="notification_phone" class="block text-sm font-semibold text-slate-700 mb-2">Notification Phone</label>
                            <input type="tel" id="notification_phone" name="notification_phone" value="+1-555-0123" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="high_volume_alert" name="high_volume_alert" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">High Call Volume Alerts</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="agent_offline_alert" name="agent_offline_alert" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Agent Offline Alerts</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="performance_alert" name="performance_alert" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Performance Threshold Alerts</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Advanced Settings Section -->
            <div class="bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-6 py-6 border-b border-slate-600/50">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-tools text-slate-900 text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Advanced Settings</h3>
                            <p class="text-slate-300 text-sm">System configuration and optimization</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="session_timeout" class="block text-sm font-semibold text-slate-700 mb-2">Session Timeout (minutes)</label>
                            <input type="number" id="session_timeout" name="session_timeout" value="30" min="5" max="480" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="max_concurrent_calls" class="block text-sm font-semibold text-slate-700 mb-2">Max Concurrent Calls</label>
                            <input type="number" id="max_concurrent_calls" name="max_concurrent_calls" value="100" min="10" max="1000" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                        
                        <div>
                            <label for="backup_frequency" class="block text-sm font-semibold text-slate-700 mb-2">Backup Frequency</label>
                            <select id="backup_frequency" name="backup_frequency" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                                <option value="daily" selected>Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="log_retention" class="block text-sm font-semibold text-slate-700 mb-2">Log Retention (days)</label>
                            <input type="number" id="log_retention" name="log_retention" value="90" min="30" max="365" class="block w-full py-3 px-4 border border-slate-300 bg-white rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm transition-all duration-200">
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="debug_mode" name="debug_mode" class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Enable Debug Mode</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="maintenance_mode" name="maintenance_mode" class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Maintenance Mode</span>
                        </label>
                        
                        <label class="flex items-center">
                            <input type="checkbox" id="auto_updates" name="auto_updates" checked class="h-4 w-4 text-amber-600 focus:ring-amber-500 border-slate-300 rounded">
                            <span class="ml-2 text-sm font-medium text-slate-700">Auto Updates</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex flex-col sm:flex-row gap-4 justify-end">
                <button type="button" onclick="resetSettings()" class="inline-flex items-center justify-center px-8 py-3 bg-white text-slate-700 font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 border-2 border-slate-200 hover:border-slate-300">
                    <i class="fas fa-undo mr-2"></i>
                    Reset to Default
                </button>
                <button type="submit" class="inline-flex items-center justify-center px-8 py-3 bg-gradient-to-r from-amber-500 to-yellow-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 border border-amber-400/20">
                    <i class="fas fa-save mr-2"></i>
                    Save Settings
                </button>
            </div>
        </form>
    </div>
</div>

<script>
function saveSettings() {
    if (confirm('Are you sure you want to save these settings?')) {
        document.querySelector('form').submit();
    }
}

function resetSettings() {
    if (confirm('Are you sure you want to reset all settings to default values? This action cannot be undone.')) {
        // Reset form fields to default values
        document.getElementById('center_name').value = 'Main Call Center';
        document.getElementById('timezone').value = 'EST';
        document.getElementById('business_hours_start').value = '09:00';
        document.getElementById('business_hours_end').value = '17:00';
        document.getElementById('welcome_message').value = 'Welcome to our call center. How may we assist you today?';
        document.getElementById('max_wait_time').value = '5';
        document.getElementById('ring_timeout').value = '30';
        document.getElementById('auto_assign').value = 'enabled';
        document.getElementById('assignment_strategy').value = 'round_robin';
        document.getElementById('voicemail_enabled').checked = true;
        document.getElementById('call_recording').checked = true;
        document.getElementById('call_monitoring').checked = false;
        document.getElementById('qa_enabled').value = 'enabled';
        document.getElementById('qa_sample_rate').value = '20';
        document.getElementById('min_qa_score').value = '80';
        document.getElementById('qa_frequency').value = 'weekly';
        document.getElementById('qa_criteria').value = '1. Greeting and Introduction\n2. Problem Identification\n3. Solution Provided\n4. Customer Satisfaction\n5. Call Handling Efficiency';
        document.getElementById('email_notifications').value = 'enabled';
        document.getElementById('sms_notifications').value = 'disabled';
        document.getElementById('notification_email').value = 'manager@callcenter.com';
        document.getElementById('notification_phone').value = '+1-555-0123';
        document.getElementById('high_volume_alert').checked = true;
        document.getElementById('agent_offline_alert').checked = true;
        document.getElementById('performance_alert').checked = true;
        document.getElementById('session_timeout').value = '30';
        document.getElementById('max_concurrent_calls').value = '100';
        document.getElementById('backup_frequency').value = 'daily';
        document.getElementById('log_retention').value = '90';
        document.getElementById('debug_mode').checked = false;
        document.getElementById('maintenance_mode').checked = false;
        document.getElementById('auto_updates').checked = true;
        
        alert('Settings have been reset to default values');
    }
}

// Auto-save form data periodically
setInterval(function() {
    const formData = new FormData(document.querySelector('form'));
    const data = {};
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    localStorage.setItem('callCenterSettingsDraft', JSON.stringify(data));
}, 30000); // Save every 30 seconds

// Load draft data on page load
document.addEventListener('DOMContentLoaded', function() {
    const draft = localStorage.getItem('callCenterSettingsDraft');
    if (draft) {
        try {
            const data = JSON.parse(draft);
            for (let [key, value] of Object.entries(data)) {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = value === 'on' || value === true;
                    } else {
                        element.value = value;
                    }
                }
            }
        } catch (e) {
            console.log('No draft data to load');
        }
    }
});

// Form validation
document.querySelector('form').addEventListener('submit', function(e) {
    const centerName = document.getElementById('center_name').value.trim();
    const notificationEmail = document.getElementById('notification_email').value.trim();
    
    if (!centerName) {
        e.preventDefault();
        alert('Please enter a call center name');
        document.getElementById('center_name').focus();
        return;
    }
    
    if (notificationEmail && !isValidEmail(notificationEmail)) {
        e.preventDefault();
        alert('Please enter a valid email address for notifications');
        document.getElementById('notification_email').focus();
        return;
    }
});

function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
</script>
{% endblock %}
